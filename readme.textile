h1. Simpex â€“ Ruby library for simple ImpEx generation

The impex torture is over guys! Enjoy your hybris projects with a nice ruby api for impex generation!

Simpex will make your life easier because:

* it will remove the "csv noise" from your eyes
* let you focus on the important stuff, building relationships between your impex tables
* process any incoming format like xml, excel, csv with the power of ruby
* do basic impex validations for you before hybris does it


Here is a first sample:

@
    category_macros = "$catalogversion=catalogversion(catalog(id[default='simpexproducts']), version[default='staged'])[unique=true,default='simpexproducts:staged']"
    product_macros  = "$catalogversion=catalogversion(catalog(id[default='simpexproducts']), version[default='staged'])[unique=true,default='simpexproducts:staged']\n" +
      "$prices=europe1Prices[translator=de.hybris.platform.europe1.jalo.impex.Europe1PricesTranslator]\n" +
      "$baseProduct=baseProduct(code, catalogVersion(catalog(id[default='SimpexProducts']), version[default='Staged']));;;;;;;;"

    category_cols = %w{code[unique=true] $catalogVersion name[lang=de] name[lang=en] description[lang=de] description[lang=en]}
    category_type = Type.new("Category", category_cols, category_macros)

    product_cols = %w{code[unique=true] name[lang=en] name[lang=de] unit(code) $catalogVersion description[lang=en] approvalStatus(code) supercategories(code)}
    product_type = Type.new("Product", product_cols, product_macros)

    categories_names = %w{cat1 cat2 cat3}
    categories_names.each_with_index do |name, index|
      category_type << TypeEntry.new(category_type, {"code" => "333", "name" => "MyCatName"})
    end

    main_category = category_type.entries.first

    product_names = %w{prod1 prod2 prod3}
    product_names.each_with_index do |name, index|
      product = TypeEntry.new(product_type, {"code" => "333", "name" => "MyProdName"})
      product.set("supercategories" => main_category.get("code"))
    end

    category_type.to_impex("#{output_directory}/001_category.csv")
    product_type.to_impex("#{output_directory}/002_product.csv")

@

h2. Setup

rvm install 1.9.1
cd to directory and run _bundle install_

h2. ImpEx file generation

For now it only generates a dummy ImpEx file.
Run _rake simpex:generate_
You can find the generated file in 'tmp/'

Run _rake simpex:test_ to execute all tests

h2. Todo

* cleanup


h3. Different formats support

make generation dynamic (what are we going to use a input format? yaml? json?)


h3. Impex Factory

The impex factory for standard hybris types will make it possible to create a valid hybris db setup only with ruby, 
so no impex knowledge is necessary at all. This is very convinient for hybris test fixtures setup and the initial product import.


h3. Macros Library

The macros library could be some small set of typical macros used in impex, something like:

@$catalogversion=catalogversion(catalog(id[default='simpexproducts'])@

created in ruby with 

@Macros.catalog_version("simpexproducts")@


h2. Features

* we might want to use this https://github.com/aeden/activewarehouse-etl at some point for data extraction from different sources
